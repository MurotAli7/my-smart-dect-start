


<!DOCTYPE html>
<html lang="uz">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ESP32 LED Panel</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;600&display=swap" rel="stylesheet"/>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --red:       #ff2244;
      --red-dim:   #331122;
      --red-glow:  rgba(255,34,68,0.5);
      --blue:      #1166ff;
      --blue-dim:  #111233;
      --blue-glow: rgba(17,102,255,0.5);
      --bg:        #060a10;
      --panel:     #0d1520;
      --border:    #1a2a3a;
      --text:      #c8daea;
      --dim:       #3a5060;
      --green:     #22ff88;
    }

    body {
      background: var(--bg);
      font-family: 'Rajdhani', sans-serif;
      color: var(--text);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    /* Moving grid */
    body::before {
      content: '';
      position: fixed; inset: 0;
      background-image:
        linear-gradient(rgba(17,102,255,0.035) 1px, transparent 1px),
        linear-gradient(90deg, rgba(17,102,255,0.035) 1px, transparent 1px);
      background-size: 44px 44px;
      animation: gridMove 24s linear infinite;
      pointer-events: none;
    }
    @keyframes gridMove { to { transform: translateY(44px); } }

    /* Scanlines */
    body::after {
      content: '';
      position: fixed; inset: 0;
      background: repeating-linear-gradient(
        0deg, transparent, transparent 3px,
        rgba(0,0,0,0.08) 3px, rgba(0,0,0,0.08) 4px
      );
      pointer-events: none; z-index: 200;
    }

    .wrap {
      position: relative; z-index: 10;
      width: min(500px, 94vw);
      animation: rise 0.7s cubic-bezier(.22,1,.36,1) both;
    }
    @keyframes rise {
      from { opacity: 0; transform: translateY(30px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    /* ---- HEADER ---- */
    header { text-align: center; margin-bottom: 28px; }

    .logo {
      font-family: 'Orbitron', monospace;
      font-size: clamp(20px, 5vw, 28px);
      font-weight: 900;
      letter-spacing: .18em;
      background: linear-gradient(120deg, #48aaff, #aa88ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }
    .tagline {
      font-size: 11px;
      letter-spacing: .35em;
      color: var(--dim);
      text-transform: uppercase;
      margin-top: 5px;
    }

    /* ---- CONNECTION BAR ---- */
    .conn-bar {
      display: flex; align-items: center; gap: 10px;
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 9px 16px;
      margin-bottom: 20px;
      font-size: 12px;
      letter-spacing: .1em;
    }
    .dot {
      width: 8px; height: 8px; border-radius: 50%;
      transition: background .4s, box-shadow .4s;
    }
    .dot.server  { background: var(--dim); }
    .dot.server.ok  { background: var(--green); box-shadow: 0 0 8px var(--green); animation: blink 2s ease-in-out infinite; }
    .dot.esp32   { background: var(--dim); }
    .dot.esp32.ok   { background: #ffaa00; box-shadow: 0 0 8px #ffaa00; animation: blink 2.4s ease-in-out infinite; }

    @keyframes blink { 0%,100%{opacity:1} 50%{opacity:.45} }

    .conn-label { flex:1; color: var(--text); }
    .conn-esp   { font-size: 11px; }
    .conn-esp.ok { color: #ffaa00; }
    .conn-esp.off { color: var(--dim); }

    /* ---- PANEL ---- */
    .panel {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: 18px;
      padding: 28px 22px;
      display: flex;
      flex-direction: column;
      gap: 18px;
    }

    /* ---- LED ROW ---- */
    .led-row {
      display: flex;
      align-items: center;
      gap: 18px;
      padding: 18px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: rgba(255,255,255,0.015);
      transition: border-color .35s, background .35s;
    }
    .led-row.lit-red  { border-color: var(--red);  background: rgba(255,34,68,.07); }
    .led-row.lit-blue { border-color: var(--blue); background: rgba(17,102,255,.07); }

    /* Bulb */
    .bulb {
      width: 50px; height: 50px;
      border-radius: 50%;
      flex-shrink: 0;
      position: relative;
      transition: all .4s ease;
    }
    .bulb.red  {
      background: radial-gradient(circle at 35% 32%, #883344, #220011);
      border: 2px solid #330011;
    }
    .bulb.red.on {
      background: radial-gradient(circle at 35% 32%, #ffbbcc, var(--red));
      box-shadow: 0 0 18px var(--red), 0 0 55px var(--red-glow);
      border-color: #ff6677;
    }
    .bulb.blue {
      background: radial-gradient(circle at 35% 32%, #223355, #001133);
      border: 2px solid #001133;
    }
    .bulb.blue.on {
      background: radial-gradient(circle at 35% 32%, #aaccff, var(--blue));
      box-shadow: 0 0 18px var(--blue), 0 0 55px var(--blue-glow);
      border-color: #88aaff;
    }
    .bulb::after {
      content: '';
      position: absolute;
      top: 9px; left: 11px;
      width: 11px; height: 7px;
      background: rgba(255,255,255,.22);
      border-radius: 50%;
      transform: rotate(-30deg);
    }

    /* Info */
    .info { flex: 1; }
    .led-label {
      font-family: 'Orbitron', monospace;
      font-size: 13px; font-weight: 700;
      letter-spacing: .1em;
      text-transform: uppercase;
    }
    .led-label.red  { color: var(--red); }
    .led-label.blue { color: var(--blue); }

    .led-status {
      font-size: 11px;
      color: var(--dim);
      letter-spacing: .18em;
      text-transform: uppercase;
      margin-top: 3px;
      transition: color .3s;
    }
    .led-status.on { color: #aaffcc; }

    /* Button */
    .btn {
      padding: 10px 20px;
      border: none; border-radius: 8px;
      font-family: 'Orbitron', monospace;
      font-size: 10px; font-weight: 700;
      letter-spacing: .15em;
      text-transform: uppercase;
      cursor: pointer;
      transition: all .2s;
      position: relative; overflow: hidden;
    }
    .btn:disabled { opacity: .35; cursor: not-allowed; }
    .btn::after { content:''; position:absolute; inset:0; background:rgba(255,255,255,.12); opacity:0; transition:opacity .2s; }
    .btn:not(:disabled):hover::after { opacity:1; }
    .btn:not(:disabled):active { transform: scale(.95); }

    .btn-red  { background: linear-gradient(135deg,#aa1122,var(--red)); color:#fff; box-shadow:0 4px 14px rgba(255,34,68,.28); }
    .btn-red:not(:disabled):hover  { box-shadow:0 4px 26px rgba(255,34,68,.55); }
    .btn-blue { background: linear-gradient(135deg,#0033aa,var(--blue)); color:#fff; box-shadow:0 4px 14px rgba(17,102,255,.28); }
    .btn-blue:not(:disabled):hover { box-shadow:0 4px 26px rgba(17,102,255,.55); }

    /* ---- LOG ---- */
    .log-box {
      background: #080e18;
      border: 1px solid var(--border);
      border-radius: 10px;
      padding: 12px 14px;
      font-family: monospace;
      font-size: 11px;
      color: #4a7;
      height: 80px;
      overflow-y: auto;
      display: flex;
      flex-direction: column-reverse;
    }
    .log-box p { margin: 1px 0; opacity:.85; }
    .log-box p.err { color: #f55; }
    .log-box p.info { color: #5af; }

    footer {
      text-align: center;
      margin-top: 20px;
      font-size: 10px;
      color: var(--dim);
      letter-spacing: .22em;
      text-transform: uppercase;
    }
  </style>
</head>
<body>
<div class="wrap">

  <header>
    <div class="logo">ESP32 Control</div>
    <div class="tagline">Global WebSocket Panel</div>
  </header>

  <!-- Connection status -->
  <div class="conn-bar">
    <div class="dot server" id="dot-server"></div>
    <span class="conn-label" id="lbl-server">Server: ulanmoqda...</span>
    <div class="dot esp32" id="dot-esp32"></div>
    <span class="conn-esp off" id="lbl-esp32">ESP32: offline</span>
  </div>

  <!-- LED controls -->
  <div class="panel">

    <div class="led-row" id="row-red">
      <div class="bulb red" id="bulb-red"></div>
      <div class="info">
        <div class="led-label red">Qizil LED</div>
        <div class="led-status" id="status-red">O'chiq</div>
      </div>
      <button class="btn btn-red" id="btn-red" disabled onclick="toggleLED('red')">Yoq</button>
    </div>

    <div class="led-row" id="row-blue">
      <div class="bulb blue" id="bulb-blue"></div>
      <div class="info">
        <div class="led-label blue">Ko'k LED</div>
        <div class="led-status" id="status-blue">O'chiq</div>
      </div>
      <button class="btn btn-blue" id="btn-blue" disabled onclick="toggleLED('blue')">Yoq</button>
    </div>

    <!-- Log -->
    <div class="log-box" id="log"></div>
  </div>

  <footer>WebSocket &mdash; Node.js &mdash; ESP32</footer>
</div>

<script>
  // =============================================
  // O'zingizning server manzilingizni kiriting!
  // Masalan: wss://myapp.onrender.com
  // =============================================
  const WS_URL = 'wss://my-smart-dect-start-1.onrender.com';

  const state = { red: false, blue: false };
  let ws, reconnectTimer;

  function log(text, type='') {
    const box = document.getElementById('log');
    const p = document.createElement('p');
    if (type) p.className = type;
    p.textContent = `[${new Date().toLocaleTimeString()}] ${text}`;
    box.prepend(p);
    if (box.children.length > 40) box.lastChild.remove();
  }

  function connect() {
    ws = new WebSocket(WS_URL);

    ws.onopen = () => {
      ws.send(JSON.stringify({ type: 'register', device: 'browser' }));
      setServerStatus(true);
      log('Serverga ulandi', 'info');
    };

    ws.onmessage = ({ data }) => {
      let msg;
      try { msg = JSON.parse(data); } catch { return; }

      if (msg.type === 'state') {
        state.red  = msg.red;
        state.blue = msg.blue;
        updateUI('red');
        updateUI('blue');
        if (msg.esp32_connected !== undefined) setESP32Status(msg.esp32_connected);
      }
      if (msg.type === 'esp32_connected') {
        setESP32Status(msg.connected);
        log(msg.connected ? 'ESP32 ulandi ✓' : 'ESP32 uzildi ✗', msg.connected ? 'info' : 'err');
      }
    };

    ws.onclose = () => {
      setServerStatus(false);
      setESP32Status(false);
      log('Server bilan aloqa uzildi, qayta ulanmoqda...', 'err');
      reconnectTimer = setTimeout(connect, 3000);
    };

    ws.onerror = () => log('WebSocket xato', 'err');
  }

  function toggleLED(color) {
    const action = state[color] ? 'off' : 'on';
    ws.send(JSON.stringify({ type: 'led', color, action }));
    log(`${color === 'red' ? 'Qizil' : 'Ko\'k'} LED → ${action === 'on' ? 'YOQILDI' : 'O\'CHIRILDI'}`);
  }

  function updateUI(color) {
    const on = state[color];
    document.getElementById(`bulb-${color}`).classList.toggle('on', on);
    const s = document.getElementById(`status-${color}`);
    s.textContent = on ? 'Yoniq ✦' : 'O\'chiq';
    s.className = `led-status${on ? ' on' : ''}`;
    const b = document.getElementById(`btn-${color}`);
    b.textContent = on ? 'O\'chir' : 'Yoq';
    document.getElementById(`row-${color}`).className = `led-row${on ? ` lit-${color}` : ''}`;
  }

  function setServerStatus(ok) {
    document.getElementById('dot-server').className = `dot server${ok ? ' ok' : ''}`;
    document.getElementById('lbl-server').textContent = `Server: ${ok ? 'ulandi' : 'uzildi'}`;
    document.getElementById('btn-red').disabled  = !ok;
    document.getElementById('btn-blue').disabled = !ok;
  }

  function setESP32Status(ok) {
    document.getElementById('dot-esp32').className = `dot esp32${ok ? ' ok' : ''}`;
    const el = document.getElementById('lbl-esp32');
    el.textContent = `ESP32: ${ok ? 'online' : 'offline'}`;
    el.className   = `conn-esp ${ok ? 'ok' : 'off'}`;
  }

  connect();
</script>
</body>
</html>
Look over my code and give me tips - Claude